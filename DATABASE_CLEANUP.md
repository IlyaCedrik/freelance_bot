# –£–ø—Ä–æ—â–µ–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∞ —É–ø—Ä–æ—â–µ–Ω–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞. –¢–µ–ø–µ—Ä—å –≤ –±–∞–∑–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ø–ª–∞—Ç–µ–∂–µ–π.

## –£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### ‚ùå `jobs` - –∑–∞—è–≤–∫–∏
**–ü—Ä–∏—á–∏–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è:** –ü–∞—Ä—Å–µ—Ä —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ –∏ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞—è–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

**–ß—Ç–æ –±—ã–ª–æ:**
- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–ø–∞—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫
- –°–≤—è–∑—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –ø–æ `category_id`
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

### ‚ùå `sent_jobs` - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏
**–ü—Ä–∏—á–∏–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è:** –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ.

**–ß—Ç–æ –±—ã–ª–æ:**
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–æ–∫
- –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∑–∞—è–≤–∫–∞–º–∏
- –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–ø—Ä–∞–≤–æ–∫

## –û—Å—Ç–∞–≤—à–∏–µ—Å—è —Ç–∞–±–ª–∏—Ü—ã

### ‚úÖ `categories` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
**–ó–∞—á–µ–º –Ω—É–∂–Ω–∞:** –î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ø–ª–∞—Ç–µ–∂–µ–π –≤ –±–æ—Ç–µ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```sql
CREATE TABLE categories (
  id UUID PRIMARY KEY,
  name VARCHAR(100) NOT NULL UNIQUE,
  description TEXT,
  price INTEGER NOT NULL DEFAULT 500, -- Price in kopecks
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### ‚úÖ `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
**–ó–∞—á–µ–º –Ω—É–∂–Ω–∞:** –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –±–æ—Ç–∞.

### ‚úÖ `subscriptions` - –ø–æ–¥–ø–∏—Å–∫–∏
**–ó–∞—á–µ–º –Ω—É–∂–Ω–∞:** –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

**–°–≤—è–∑—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏:** `category_id ‚Üí categories.id`

### ‚úÖ `payments` - –ø–ª–∞—Ç–µ–∂–∏
**–ó–∞—á–µ–º –Ω—É–∂–Ω–∞:** –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –ø–æ–¥–ø–∏—Å–∫–∏.

**–°–≤—è–∑—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏:** `category_id ‚Üí categories.id`

## –ú–∏–≥—Ä–∞—Ü–∏—è

–§–∞–π–ª: `supabase/migrations/002_remove_jobs_tables.sql`

```sql
-- Drop sent_jobs table first (has foreign key to jobs)
DROP TABLE IF EXISTS sent_jobs;

-- Drop jobs table
DROP TABLE IF EXISTS jobs;

-- Remove related indexes
DROP INDEX IF EXISTS idx_jobs_category_id;
DROP INDEX IF EXISTS idx_jobs_published_at;
DROP INDEX IF EXISTS idx_jobs_source;
DROP INDEX IF EXISTS idx_sent_jobs_user_id;
```

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### –£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `src/database/models/Job.js` - –º–æ–¥–µ–ª—å –∑–∞—è–≤–æ–∫

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### `src/services/databaseService.js`
**–£–¥–∞–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:**
- `createJob()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
- `getJobByExternalId()` - –ø–æ–∏—Å–∫ –ø–æ –≤–Ω–µ—à–Ω–µ–º—É ID
- `getLatestJobs()` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏
- `getJobsByCategory()` - –∑–∞—è–≤–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `markJobAsSent()` - –æ—Ç–º–µ—Ç–∫–∞ –æ–± –æ—Ç–ø—Ä–∞–≤–∫–µ
- `getJobsForUser()` - –∑–∞—è–≤–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `getJobsStats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫

**–û—Å—Ç–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:**
- `getCategories()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `getCategoryById()` - –ø–æ–∏—Å–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ ID
- `testConnection()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

#### `src/utils/testScheduler.js`
- –£–¥–∞–ª–µ–Ω `testJobQuery()` - —Ç–µ—Å—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞—è–≤–æ–∫
- –î–æ–±–∞–≤–ª–µ–Ω `testCategoriesQuery()` - —Ç–µ—Å—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ù–µ—Ç –∑–∞–ø–∏—Å–∏/—á—Ç–µ–Ω–∏—è –∑–∞—è–≤–æ–∫ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –£–º–µ–Ω—å—à–µ–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Supabase
- –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫

### üîß –ü—Ä–æ—Å—Ç–æ—Ç–∞
- –ú–µ–Ω—å—à–µ —Ç–∞–±–ª–∏—Ü –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
- –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- –ú–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞

### üí∞ –≠–∫–æ–Ω–æ–º–∏—è
- –ú–µ–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ Supabase
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

## –ú–∞–ø–ø–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

–ü–∞—Ä—Å–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –º–∞–ø–ø–∏—Ç –∏—Ö –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```javascript
// –í –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ (scheduler.js)
const categoryMapping = {
  '–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞': 'web',
  '–ú–æ–±–∏–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞': 'mobile', 
  '–î–∏–∑–∞–π–Ω': 'design',
  '–ö–æ–ø–∏—Ä–∞–π—Ç–∏–Ω–≥': 'copywriting',
  '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥': 'marketing',
  '–ü–µ—Ä–µ–≤–æ–¥—ã': 'translation'
};

// –í –ø–∞—Ä—Å–µ—Ä–µ (telegramParser.js)
this.categories = [
  { id: 'web', name: '–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞' },
  { id: 'mobile', name: '–ú–æ–±–∏–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞' },
  { id: 'design', name: '–î–∏–∑–∞–π–Ω' },
  { id: 'copywriting', name: '–ö–æ–ø–∏—Ä–∞–π—Ç–∏–Ω–≥' },
  { id: 'marketing', name: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥' },
  { id: 'translation', name: '–ü–µ—Ä–µ–≤–æ–¥—ã' }
];
```

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
```bash
# –í –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
supabase db reset

# –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
supabase db push
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
```bash
# –¢–µ—Å—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π
node src/utils/testScheduler.js

# –¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
node src/runParser.js test-notifications
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è, –±—ã—Å—Ç—Ä–∞—è –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏! üéâ 